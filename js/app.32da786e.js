(function(){"use strict";var e={1434:function(e,t,o){var n=o(9242),l=o(3396);const r=(0,l._)("div",{class:"app"},null,-1);function s(e,t,o,n,s,a){const u=(0,l.up)("Editor");return(0,l.wg)(),(0,l.iD)(l.HY,null,[r,(0,l.Wm)(u,{modelValue:n.state,"onUpdate:modelValue":t[0]||(t[0]=e=>n.state=e)},null,8,["modelValue"])],64)}var a=o(4870),u=JSON.parse('{"container":{"width":"550","height":"550"},"blocks":[{"top":100,"left":100,"zIndex":1,"key":"text"},{"top":200,"left":200,"zIndex":1,"key":"button"},{"top":300,"left":300,"zIndex":1,"key":"input"}]}'),c=(0,l.aZ)({props:{block:{type:Object}},setup(e){const t=(0,l.Fl)((()=>({top:`${e.block.top}px`,left:`${e.block.left}px`,zIndex:`${e.block.zIndex}`}))),o=(0,l.f3)("config"),n=(0,a.iH)(null);return(0,l.bv)((()=>{let{offsetWidth:t,offsetHeight:o}=n.value;e.block.alignCenter&&(e.block.left=e.block.left-t/2,e.block.top=e.block.top-o/2,e.block.alignCenter=!1),e.block.width=t,e.block.height=o})),()=>{const r=o.componmentMap[e.block.key],s=r.render();return(0,l.Wm)("div",{class:"editor-block",style:t.value,ref:n},[s])}}}),i=o(2177),f=o.n(i);function d(e,t){let o=null;const n=e=>{e.dataTransfer.dropEffect="move"},l=e=>{e.preventDefault()},r=e=>{e.dataTransfer.dropEffect="none"},s=e=>{console.log(o);let n=t.value.blocks;t.value={...t.value,blocks:[...n,{top:e.offsetY,left:e.offsetX,zIndex:1,key:o.key,alignCenter:!0}]},o=null},a=(t,a)=>{e.value.addEventListener("dragenter",n),e.value.addEventListener("dragover",l),e.value.addEventListener("dragleave",r),e.value.addEventListener("drop",s),o=a},u=t=>{e.value.removeEventListener("drageneter",n),e.value.removeEventListener("dragover",l),e.value.removeEventListener("dragleave",r),e.value.removeEventListener("drop",s)};return{dragstart:a,dragend:u}}function p(e,t){const o=(0,a.iH)(-1),n=(0,l.Fl)((()=>e.value.blocks[o.value])),r=(0,l.Fl)((()=>{let t=[],o=[];return e.value.blocks.forEach((e=>(e.focus?t:o).push(e))),{focus:t,unfocused:o}})),s=()=>{e.value.blocks.forEach((e=>e.focus=!1))},u=(e,n,l)=>{e.preventDefault(),e.stopPropagation(),e.shiftKey?n.focus=!n.focus:n.focus?n.focus=!1:(s(),n.focus=!0),o.value=l,t(e)};return{blockMousedown:u,focusData:r,lastIndexBlock:n}}function v(e,t){let o={startX:0,startY:0},n=(0,a.qj)({x:null,y:null});const l=n=>{const{width:l,height:a}=t.value;o={startX:n.clientX,startY:n.clientY,startLeft:t.value.left,startTop:t.value.top,startPos:e.value.focus.map((({top:e,left:t})=>({top:e,left:t}))),lines:(()=>{const{unfocused:t}=e.value;let o={x:[],y:[]};return t.forEach((e=>{const{top:t,left:n,width:r,height:s}=e;o.y.push({showTop:t,top:t}),o.y.push({showTop:t,top:t-a}),o.y.push({showTop:t+s/2,top:t+s/2-a/2}),o.y.push({showTop:t+s,top:t+s}),o.y.push({showTop:t+s,top:t+s-a}),o.x.push({showLeft:n,left:n}),o.x.push({showLeft:n+r,left:n+r}),o.x.push({showLeft:n+r/2,left:n+r/2-l/2}),o.x.push({showLeft:n+r,left:n+r-l}),o.x.push({showLeft:n,left:n-l})})),o})()},document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)},r=t=>{let{clientX:l,clientY:r}=t,s=null,a=null,u=l-o.startX+o.startLeft,c=r-o.startY+o.startTop;for(let e=0;e<o.lines.y.length;e++){const{top:t,showTop:n}=o.lines.y[e];if(Math.abs(t-c)<5){s=n,r=o.startY-o.startTop+t;break}}for(let e=0;e<o.lines.x.length;e++){const{left:t,showLeft:n}=o.lines.x[e];if(Math.abs(t-u)<5){a=n,l=o.startX-o.startLeft+t;break}}n.x=a,n.y=s;let i=l-o.startX,f=r-o.startY;e.value.focus.forEach(((e,t)=>{e.top=o.startPos[t].top+f,e.left=o.startPos[t].left+i}))},s=e=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};return{mousedown:l,markLine:n}}var h=(0,l.aZ)({props:{modelValue:{type:Object}},emits:["update:modelValue"],setup(e,t){const o=(0,l.Fl)({get(){return e.modelValue},set(e){t.emit("update:modelValue",f()(e))}}),n=(0,l.Fl)((()=>({width:o.value.container.width+"px",height:o.value.container.height+"px"}))),r=(0,l.f3)("config"),s=(0,a.iH)(null),{dragstart:u,dragend:i}=d(s,o);let{blockMousedown:h,focusData:m,lastIndexBlock:b}=p(o,(e=>{k(e)})),{mousedown:k,markLine:g}=v(m,b);const y=e=>{o.value.blocks.forEach((e=>e.focus=!1))},w=()=>{y()},x=[{label:"撤销",icon:"icon-back",handler:()=>console.log(撤销)},{label:"重做",icon:"icon-back",handler:()=>console.log(撤销)}];return()=>(0,l.Wm)("div",{class:"editor"},[(0,l.Wm)("div",{class:"editor-left"},[r.componmentlist.map((e=>(0,l.Wm)("div",{class:"editor-left-item",draggable:!0,onDragstart:t=>u(t,e)},[(0,l.Wm)("span",null,[e.label]),(0,l.Wm)("div",null,[e.preview()])])))]),(0,l.Wm)("div",{class:"editor-top"},[x.map(((e,t)=>(0,l.Wm)("div",{class:"editor-top-button",onClick:e.handler},[(0,l.Wm)("i",{class:e.icon},null),(0,l.Wm)("i",{class:e.label},null)])))]),(0,l.Wm)("div",{class:"editor-right"},[(0,l.Uk)("删除区")]),(0,l.Wm)("div",{class:"editor-container"},[(0,l.Wm)("div",{class:"editor-container-canvas"},[(0,l.Wm)("div",{class:"editor-container-canvas__content",style:n.value,ref:s,onMousedown:w},[o.value.blocks.map(((e,t)=>(0,l.Wm)(c,{class:e.focus?"editor-block-focus":"",block:e,onMousedown:o=>h(o,e,t)},{default:()=>[(0,l.Uk)("sdjsd")]}))),null!==g.x&&(0,l.Wm)("div",{class:"line-x",style:{left:g.x+"px"}},null),null!==g.y&&(0,l.Wm)("div",{class:"line-y",style:{top:g.y+"px"}},null)])])])])}}),m=o(2521),b=o(4779);function k(){const e=[],t={};return{componmentMap:t,componmentlist:e,register:o=>{e.push(o),t[o.key]=o}}}let g=k();g.register({label:"文本",preview:()=>"预览文本",render:()=>"渲染文本",key:"text"}),g.register({label:"按钮",preview:()=>(0,l.Wm)(m.mi,null,{default:()=>[(0,l.Uk)("预览按钮")]}),render:()=>(0,l.Wm)(m.mi,null,{default:()=>[(0,l.Uk)("渲染按钮")]}),key:"button"}),g.register({label:"输入框",preview:()=>(0,l.Wm)(b.EZ,{placeholder:"预览输入框"},null),render:()=>(0,l.Wm)(b.EZ,{placeholder:"渲染输入框"},null),key:"input"});const y=JSON.parse(localStorage.getItem("todos")),w=(0,a.iH)(u);const x=y||w;var E={components:{Editor:h},setup(){const e=(0,a.iH)(x);return(0,l.JJ)("config",g),{state:e}},watch:{state(e){localStorage.setItem("todos",JSON.stringify(e))}}},L=o(89);const W=(0,L.Z)(E,[["render",s]]);var O=W;o(4415);(0,n.ri)(O).mount("#app")}},t={};function o(n){var l=t[n];if(void 0!==l)return l.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,n,l,r){if(!n){var s=1/0;for(i=0;i<e.length;i++){n=e[i][0],l=e[i][1],r=e[i][2];for(var a=!0,u=0;u<n.length;u++)(!1&r||s>=r)&&Object.keys(o.O).every((function(e){return o.O[e](n[u])}))?n.splice(u--,1):(a=!1,r<s&&(s=r));if(a){e.splice(i--,1);var c=l();void 0!==c&&(t=c)}}return t}r=r||0;for(var i=e.length;i>0&&e[i-1][2]>r;i--)e[i]=e[i-1];e[i]=[n,l,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,r,s=n[0],a=n[1],u=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(l in a)o.o(a,l)&&(o.m[l]=a[l]);if(u)var i=u(o)}for(t&&t(n);c<s.length;c++)r=s[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(i)},n=self["webpackChunkproj"]=self["webpackChunkproj"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(1434)}));n=o.O(n)})();
//# sourceMappingURL=app.32da786e.js.map